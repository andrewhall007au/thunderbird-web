<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Thunderbird SMS Preview</title>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500&display=swap" rel="stylesheet">
    <style>
        * {
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: #1a1a2e;
            color: #eee;
            margin: 0;
            padding: 20px;
            min-height: 100vh;
        }

        h1 {
            text-align: center;
            color: #fff;
            margin-bottom: 10px;
        }

        .subtitle {
            text-align: center;
            color: #888;
            margin-bottom: 30px;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
        }

        .input-section {
            background: #252540;
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 30px;
        }

        .input-section h3 {
            margin-top: 0;
            color: #4ecdc4;
        }

        textarea {
            width: 100%;
            height: 200px;
            background: #1a1a2e;
            border: 1px solid #444;
            border-radius: 8px;
            color: #fff;
            font-family: 'Courier New', monospace;
            font-size: 13px;
            padding: 15px;
            resize: vertical;
        }

        textarea:focus {
            outline: none;
            border-color: #4ecdc4;
        }

        .stats {
            display: flex;
            gap: 20px;
            margin-top: 15px;
            flex-wrap: wrap;
        }

        .stat {
            background: #1a1a2e;
            padding: 10px 15px;
            border-radius: 6px;
            font-size: 14px;
        }

        .stat-label {
            color: #888;
        }

        .stat-value {
            color: #4ecdc4;
            font-weight: bold;
        }

        .stat-warning {
            color: #ff6b6b;
        }

        .phones-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
            gap: 25px;
        }

        .phone-container {
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .phone-label {
            font-size: 14px;
            color: #888;
            margin-bottom: 10px;
            text-align: center;
        }

        .phone-label strong {
            color: #fff;
            font-size: 16px;
        }

        /* iPhone Frame */
        .iphone-frame {
            width: 300px;
            height: 600px;
            background: #000;
            border-radius: 40px;
            padding: 15px;
            position: relative;
            box-shadow: 0 10px 30px rgba(0,0,0,0.5);
        }

        .iphone-notch {
            width: 120px;
            height: 25px;
            background: #000;
            border-radius: 0 0 15px 15px;
            position: absolute;
            top: 0;
            left: 50%;
            transform: translateX(-50%);
            z-index: 10;
        }

        .iphone-screen {
            width: 100%;
            height: 100%;
            background: #fff;
            border-radius: 30px;
            overflow: hidden;
            display: flex;
            flex-direction: column;
        }

        .iphone-header {
            background: #f6f6f6;
            padding: 45px 15px 10px;
            text-align: center;
            border-bottom: 1px solid #ddd;
        }

        .iphone-header-title {
            font-family: -apple-system, BlinkMacSystemFont, 'SF Pro Text', sans-serif;
            font-size: 17px;
            font-weight: 600;
            color: #000;
        }

        .iphone-messages {
            flex: 1;
            padding: 15px;
            overflow-y: auto;
            background: #fff;
        }

        .iphone-bubble {
            background: #e5e5ea;
            color: #000;
            padding: 10px 14px;
            border-radius: 18px;
            border-bottom-left-radius: 4px;
            max-width: 85%;
            font-family: -apple-system, BlinkMacSystemFont, 'SF Pro Text', sans-serif;
            font-size: 15px;
            line-height: 1.4;
            white-space: pre-wrap;
            word-break: break-word;
        }

        /* Samsung Frame */
        .samsung-frame {
            width: 300px;
            height: 600px;
            background: #1a1a1a;
            border-radius: 30px;
            padding: 10px;
            position: relative;
            box-shadow: 0 10px 30px rgba(0,0,0,0.5);
        }

        .samsung-camera {
            width: 12px;
            height: 12px;
            background: #333;
            border-radius: 50%;
            position: absolute;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            z-index: 10;
        }

        .samsung-screen {
            width: 100%;
            height: 100%;
            background: #fff;
            border-radius: 22px;
            overflow: hidden;
            display: flex;
            flex-direction: column;
        }

        .samsung-header {
            background: #f5f5f5;
            padding: 40px 15px 10px;
            text-align: center;
            border-bottom: 1px solid #e0e0e0;
        }

        .samsung-header-title {
            font-family: 'Roboto', sans-serif;
            font-size: 18px;
            font-weight: 500;
            color: #000;
        }

        .samsung-messages {
            flex: 1;
            padding: 15px;
            overflow-y: auto;
            background: #fff;
        }

        .samsung-bubble {
            background: #f0f0f0;
            color: #000;
            padding: 12px 16px;
            border-radius: 20px;
            border-bottom-left-radius: 4px;
            max-width: 85%;
            font-family: 'Roboto', sans-serif;
            font-size: 15px;
            line-height: 1.45;
            white-space: pre-wrap;
            word-break: break-word;
        }

        /* Monospace Preview */
        .mono-frame {
            width: 300px;
            height: 600px;
            background: #2d2d2d;
            border-radius: 12px;
            padding: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.5);
            display: flex;
            flex-direction: column;
        }

        .mono-header {
            padding-bottom: 10px;
            border-bottom: 1px solid #444;
            margin-bottom: 15px;
        }

        .mono-header-title {
            font-family: 'Courier New', monospace;
            font-size: 14px;
            color: #4ecdc4;
        }

        .mono-content {
            flex: 1;
            overflow-y: auto;
            font-family: 'Courier New', Consolas, monospace;
            font-size: 12px;
            line-height: 1.4;
            color: #0f0;
            white-space: pre;
            background: #1a1a1a;
            padding: 10px;
            border-radius: 6px;
        }

        /* Presets */
        .presets {
            margin-top: 15px;
        }

        .presets-label {
            color: #888;
            font-size: 14px;
            margin-bottom: 8px;
        }

        .preset-buttons {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }

        .preset-btn {
            background: #4ecdc4;
            color: #1a1a2e;
            border: none;
            padding: 8px 16px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 13px;
            font-weight: 500;
            transition: all 0.2s;
        }

        .preset-btn:hover {
            background: #3dbdb5;
            transform: translateY(-1px);
        }

        .preset-btn.recommended {
            background: #22c55e;
            box-shadow: 0 0 10px rgba(34, 197, 94, 0.4);
        }

        .preset-btn.recommended:hover {
            background: #16a34a;
        }

        .format-toggle {
            margin-top: 15px;
            display: flex;
            gap: 15px;
            align-items: center;
        }

        .format-toggle label {
            display: flex;
            align-items: center;
            gap: 8px;
            cursor: pointer;
            color: #ccc;
        }

        .format-toggle input {
            width: 18px;
            height: 18px;
            cursor: pointer;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Thunderbird SMS Preview</h1>
        <p class="subtitle">Test how forecasts look on different devices</p>

        <div class="input-section">
            <h3>SMS Content</h3>
            <textarea id="smsInput" placeholder="Paste or type SMS content here..."></textarea>

            <div class="stats">
                <div class="stat">
                    <span class="stat-label">Characters:</span>
                    <span class="stat-value" id="charCount">0</span>
                </div>
                <div class="stat">
                    <span class="stat-label">Segments:</span>
                    <span class="stat-value" id="segmentCount">0</span>
                </div>
                <div class="stat">
                    <span class="stat-label">Est. Cost (AU):</span>
                    <span class="stat-value" id="costEstimate">$0.00</span>
                </div>
                <div class="stat">
                    <span class="stat-label">Encoding:</span>
                    <span class="stat-value" id="encoding">GSM-7</span>
                </div>
            </div>

            <div class="presets">
                <div class="presets-label">Load sample forecast:</div>
                <div class="preset-buttons">
                    <button class="preset-btn" onclick="loadPreset('cast12')">Pipes (Old)</button>
                    <button class="preset-btn" onclick="loadPreset('cast12_padded')">Pipes (Padded)</button>
                    <button class="preset-btn" onclick="loadPreset('cast12_labeled')">Labeled</button>
                    <button class="preset-btn" onclick="loadPreset('cast12_labeled_spaced')">Labeled (Spaced)</button>
                    <button class="preset-btn" onclick="loadPreset('cast12_key_start')">Key at Start</button>
                    <button class="preset-btn recommended" onclick="loadPreset('cast12_key_end')">Key at End (Recommended)</button>
                    <button class="preset-btn" onclick="loadPreset('cast12_bad_weather')">Bad Weather</button>
                    <button class="preset-btn" onclick="loadPreset('cast12_imperial')">Imperial (F/ft)</button>
                    <button class="preset-btn" onclick="loadPreset('cast7')">7-Day</button>
                    <button class="preset-btn" onclick="loadPreset('key')">Full KEY</button>
                </div>
            </div>
        </div>

        <div class="phones-grid">
            <div class="phone-container">
                <div class="phone-label">
                    <strong>iPhone 14/15</strong><br>
                    San Francisco (Proportional)
                </div>
                <div class="iphone-frame">
                    <div class="iphone-notch"></div>
                    <div class="iphone-screen">
                        <div class="iphone-header">
                            <div class="iphone-header-title">Thunderbird</div>
                        </div>
                        <div class="iphone-messages">
                            <div class="iphone-bubble" id="iphonePreview"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="phone-container">
                <div class="phone-label">
                    <strong>Samsung S23 / Pixel</strong><br>
                    Roboto (Proportional)
                </div>
                <div class="samsung-frame">
                    <div class="samsung-camera"></div>
                    <div class="samsung-screen">
                        <div class="samsung-header">
                            <div class="samsung-header-title">Thunderbird</div>
                        </div>
                        <div class="samsung-messages">
                            <div class="samsung-bubble" id="samsungPreview"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="phone-container">
                <div class="phone-label">
                    <strong>Monospace View</strong><br>
                    Ideal alignment (Courier)
                </div>
                <div class="mono-frame">
                    <div class="mono-header">
                        <div class="mono-header-title">// Terminal Preview</div>
                    </div>
                    <div class="mono-content" id="monoPreview"></div>
                </div>
            </div>
        </div>
    </div>

    <script>
        const presets = {
            cast12: `CAST LAKEO
Lake Oberon (863m)
Light 06:00-20:51 (14h51m)

Hr|Tmp|%Rn|Prec|Wa|Wm|Wd|%Cd|CB|FL|D
17|21-23|0%|-|20|33|W|38%|12|48|
18|20-22|0%|-|20|33|W|49%|12|46|
19|18-20|0%|-|20|33|W|22%|12|43|
20|16-18|0%|-|19|31|W|22%|12|40|
21|13-15|0%|-|17|30|W|38%|12|35|
22|11-13|0%|-|19|30|W|31%|12|32|
23|9-11|0%|-|17|30|W|30%|12|29|
00|8-10|0%|-|17|28|W|44%|12|28|
01|8-10|0%|-|17|28|W|40%|12|28|
02|7-9|0%|-|17|28|W|39%|12|26|
03|6-8|0%|-|15|26|W|49%|12|24|
04|6-8|0%|-|15|24|W|42%|12|24|`,

            cast12_padded: `CAST LAKEO
Lake Oberon (863m)
Light 06:00-20:51 (14h51m)

Hr|Tmp  | %Rn|Prec|Wa|Wm|Wd| %Cd|CB|FL|D
17|21-23|  0%|   -|20|33| W| 38%|12|48|
18|20-22|  0%|   -|20|33| W| 49%|12|46|
19|18-20|  0%|   -|20|33| W| 22%|12|43|
20|16-18|  0%|   -|19|31| W| 22%|12|40|
21|13-15|  0%|   -|17|30| W| 38%|12|35|
22|11-13|  0%|   -|19|30| W| 31%|12|32|
23| 9-11|  0%|   -|17|30| W| 30%|12|29|
00| 8-10|  0%|   -|17|28| W| 44%|12|28|
01| 8-10|  0%|   -|17|28| W| 40%|12|28|
02| 7-9 |  0%|   -|17|28| W| 39%|12|26|
03| 6-8 |  0%|   -|15|26| W| 49%|12|24|
04| 6-8 |  0%|   -|15|24| W| 42%|12|24|   `,

            cast7: `CAST7 LAKEO
Lake Oberon (863m)
7-Day Forecast

Day|Tmp|%Rn|Prec|Wa|Wm|%Cd|FL
Tue|7-18|0%|-|7|45|60%|38
Wed|3-11|75%|R0-9|6|50|88%|15
Thu|2-9|28%|R0-0|10|47|73%|13
Fri|0-14|3%|-|5|32|63%|32
Sat|4-26|3%|R0-0|11|61|85%|39
Sun|4-12|3%|-|7|38|63%|37
Mon|4-21|18%|R0-0|4|29|58%|42`,

            cast12_labeled: `CAST LAKEO 863m
Light 06:00-20:51

17h 21-23o Rn0% W20-33 Cld38% CB12 FL48
18h 20-22o Rn0% W20-33 Cld49% CB12 FL46
19h 18-20o Rn0% W20-33 Cld22% CB12 FL43
20h 16-18o Rn0% W19-31 Cld22% CB12 FL40
21h 13-15o Rn0% W17-30 Cld38% CB12 FL35
22h 11-13o Rn0% W19-30 Cld31% CB12 FL32
23h 9-11o Rn0% W17-30 Cld30% CB12 FL29
00h 8-10o Rn0% W17-28 Cld44% CB12 FL28
01h 8-10o Rn0% W17-28 Cld40% CB12 FL28
02h 7-9o Rn0% W17-28 Cld39% CB12 FL26
03h 6-8o Rn0% W15-26 Cld49% CB12 FL24
04h 6-8o Rn0% W15-24 Cld42% CB12 FL24`,

            cast12_labeled_spaced: `CAST LAKEO 863m
Light 06:00-20:51

17h 21-23o Rn0% W20-33 Cld38% CB12 FL48

18h 20-22o Rn0% W20-33 Cld49% CB12 FL46

19h 18-20o Rn0% W20-33 Cld22% CB12 FL43

20h 16-18o Rn0% W19-31 Cld22% CB12 FL40

21h 13-15o Rn0% W17-30 Cld38% CB12 FL35

22h 11-13o Rn0% W19-30 Cld31% CB12 FL32

23h 9-11o Rn0% W17-30 Cld30% CB12 FL29

00h 8-10o Rn0% W17-28 Cld44% CB12 FL28

01h 8-10o Rn0% W17-28 Cld40% CB12 FL28

02h 7-9o Rn0% W17-28 Cld39% CB12 FL26

03h 6-8o Rn0% W15-26 Cld49% CB12 FL24

04h 6-8o Rn0% W15-24 Cld42% CB12 FL24`,

            cast12_key_end: `CAST LAKEO 863m
Light 06:00-20:51

17h 21-23o Rn0% W20-33 Cld38% CB12 FL48

18h 20-22o Rn0% W20-33 Cld49% CB12 FL46

19h 18-20o Rn0% W20-33 Cld22% CB12 FL43

20h 16-18o Rn0% W19-31 Cld22% CB12 FL40

21h 13-15o Rn0% W17-30 Cld38% CB12 FL35

22h 11-13o Rn0% W19-30 Cld31% CB12 FL32

23h 9-11o Rn0% W17-30 Cld30% CB12 FL29

00h 8-10o Rn0% W17-28 Cld44% CB12 FL28

01h 8-10o Rn0% W17-28 Cld40% CB12 FL28

02h 7-9o Rn0% W17-28 Cld39% CB12 FL26

03h 6-8o Rn0% W15-26 Cld49% CB12 FL24

04h 6-8o Rn0% W15-24 Cld42% CB12 FL24

Rn=Rain W=Wind Cld=Cloud CB=CloudBase(x100m) FL=Freeze(x100m)`,

            cast12_key_start: `CAST LAKEO 863m
Light 06:00-20:51
Rn=Rain W=Wind Cld=Cloud CB=CloudBase(x100m) FL=Freeze(x100m)

17h 21-23o Rn0% W20-33 Cld38% CB12 FL48

18h 20-22o Rn0% W20-33 Cld49% CB12 FL46

19h 18-20o Rn0% W20-33 Cld22% CB12 FL43

20h 16-18o Rn0% W19-31 Cld22% CB12 FL40

21h 13-15o Rn0% W17-30 Cld38% CB12 FL35

22h 11-13o Rn0% W19-30 Cld31% CB12 FL32

23h 9-11o Rn0% W17-30 Cld30% CB12 FL29

00h 8-10o Rn0% W17-28 Cld44% CB12 FL28

01h 8-10o Rn0% W17-28 Cld40% CB12 FL28

02h 7-9o Rn0% W17-28 Cld39% CB12 FL26

03h 6-8o Rn0% W15-26 Cld49% CB12 FL24

04h 6-8o Rn0% W15-24 Cld42% CB12 FL24`,

            cast12_compact: `LAKEO 863m 06:00-20:51

17 21o 0% W20/33 38% CB12 FL48
18 20o 0% W20/33 49% CB12 FL46
19 18o 0% W20/33 22% CB12 FL43
20 16o 0% W19/31 22% CB12 FL40
21 13o 0% W17/30 38% CB12 FL35
22 11o 0% W19/30 31% CB12 FL32
23  9o 0% W17/30 30% CB12 FL29
00  8o 0% W17/28 44% CB12 FL28
01  8o 0% W17/28 40% CB12 FL28

T %Rn Wavg/max %Cld CB=CloudBase FL=Freeze`,

            cast12_stacked: `CAST LAKEO 863m

17:00 21-23o
Rn0% W20-33 Cld38% CB12 FL48

18:00 20-22o
Rn0% W20-33 Cld49% CB12 FL46

19:00 18-20o
Rn0% W20-33 Cld22% CB12 FL43

20:00 16-18o
Rn0% W19-31 Cld22% CB12 FL40`,

            cast12_bad_weather: `CAST LAKEO 863m
Light 06:00-20:51

06h 2-4o Rn85% 4-8mm W45-68 Cld95% CB8 FL12 !!

07h 1-3o Rn90% 6-12mm W50-72 Cld98% CB6 FL10 !!!

08h 0-2o Rn95% 8-15mm W55-80 Cld100% CB5 FL8 !!!

09h 1-3o Rn80% 4-9mm W48-65 Cld92% CB7 FL10 !!

10h 3-5o Rn65% 2-6mm W40-58 Cld85% CB9 FL14 !

11h 4-6o Rn50% 1-4mm W35-52 Cld78% CB10 FL16 !

12h 5-8o Rn40% 0-2mm W30-45 Cld65% CB11 FL18

13h 6-9o Rn25% W25-40 Cld55% CB12 FL20

14h 7-10o Rn15% W22-35 Cld45% CB12 FL22

15h 6-9o Rn20% W25-38 Cld50% CB11 FL20

16h 5-7o Rn35% 0-2mm W30-42 Cld60% CB10 FL18

17h 3-5o Rn45% 1-3mm W35-48 Cld70% CB9 FL16 !

Rn=Rain W=Wind Cld=Cloud CB=CloudBase(x100m) FL=Freeze(x100m)`,

            cast12_imperial: `CAST LAKEO 2831ft
Light 06:00-20:51

17h 70-73f Rn0% W20-33 Cld38% CB39 FL157

18h 68-72f Rn0% W20-33 Cld49% CB39 FL150

19h 64-68f Rn0% W20-33 Cld22% CB39 FL141

20h 61-64f Rn0% W19-31 Cld22% CB39 FL131

21h 55-59f Rn0% W17-30 Cld38% CB39 FL114

22h 52-55f Rn0% W19-30 Cld31% CB39 FL105

23h 48-52f Rn0% W17-30 Cld30% CB39 FL95

00h 46-50f Rn0% W17-28 Cld44% CB39 FL92

01h 46-50f Rn0% W17-28 Cld40% CB39 FL92

02h 45-48f Rn0% W17-28 Cld39% CB39 FL85

03h 43-46f Rn0% W15-26 Cld49% CB39 FL79

04h 43-46f Rn0% W15-24 Cld42% CB39 FL79

Rn=Rain W=Wind Cld=Cloud CB=CloudBase(x100ft) FL=Freeze(x100ft)`,

            key: `FORECAST KEY
Hr  = Hour (24h)
Tmp = Temp range C
%Rn = Rain chance
Prec = Precip mm (R=rain S=snow)
Wa  = Wind avg km/h
Wm  = Wind max km/h
Wd  = Wind direction
%Cld = Cloud cover
CB  = Cloud base (x100m)
FL  = Freezing lvl (x100m)
D   = Danger (!-!!!)`
        };

        const smsInput = document.getElementById('smsInput');
        const iphonePreview = document.getElementById('iphonePreview');
        const samsungPreview = document.getElementById('samsungPreview');
        const monoPreview = document.getElementById('monoPreview');
        const charCount = document.getElementById('charCount');
        const segmentCount = document.getElementById('segmentCount');
        const costEstimate = document.getElementById('costEstimate');
        const encoding = document.getElementById('encoding');

        // GSM-7 character set (basic)
        const GSM7_BASIC = '@£$¥èéùìòÇ\nØø\rÅåΔ_ΦΓΛΩΠΨΣΘΞ !"#¤%&\'()*+,-./0123456789:;<=>?¡ABCDEFGHIJKLMNOPQRSTUVWXYZÄÖÑÜ§¿abcdefghijklmnopqrstuvwxyzäöñüà';
        const GSM7_EXTENDED = '|^€{}[~]\\';

        function isGSM7(text) {
            for (let char of text) {
                if (!GSM7_BASIC.includes(char) && !GSM7_EXTENDED.includes(char)) {
                    return false;
                }
            }
            return true;
        }

        function countGSM7Chars(text) {
            let count = 0;
            for (let char of text) {
                if (GSM7_EXTENDED.includes(char)) {
                    count += 2; // Extended chars count as 2
                } else {
                    count += 1;
                }
            }
            return count;
        }

        function calculateSegments(text) {
            if (!text) return 0;

            const isGsm = isGSM7(text);

            if (isGsm) {
                const charLen = countGSM7Chars(text);
                if (charLen <= 160) return 1;
                return Math.ceil(charLen / 153); // Concatenated SMS
            } else {
                // UCS-2 encoding
                const charLen = text.length;
                if (charLen <= 70) return 1;
                return Math.ceil(charLen / 67); // Concatenated SMS
            }
        }

        function updatePreview() {
            const text = smsInput.value;

            // Update phone previews
            iphonePreview.textContent = text || 'Preview will appear here...';
            samsungPreview.textContent = text || 'Preview will appear here...';
            monoPreview.textContent = text || 'Preview will appear here...';

            // Update stats
            const chars = text.length;
            const gsm7Chars = countGSM7Chars(text);
            const isGsm = isGSM7(text);
            const segments = calculateSegments(text);
            const cost = (segments * 0.08).toFixed(2); // AU rate

            charCount.textContent = isGsm ? gsm7Chars : chars;
            segmentCount.textContent = segments;
            segmentCount.className = segments > 4 ? 'stat-value stat-warning' : 'stat-value';
            costEstimate.textContent = `$${cost}`;
            encoding.textContent = isGsm ? 'GSM-7' : 'UCS-2 (Unicode)';
            encoding.className = isGsm ? 'stat-value' : 'stat-value stat-warning';
        }

        function loadPreset(name) {
            if (presets[name]) {
                smsInput.value = presets[name];
                updatePreview();
            }
        }

        smsInput.addEventListener('input', updatePreview);

        // Load default
        loadPreset('cast12_padded');
    </script>
</body>
</html>
