---
phase: 10-real-trail-data
plan: 02
type: execute
wave: 1
depends_on: []
files_modified:
  - app/components/trails/TrailSelector.tsx
autonomous: true

must_haves:
  truths:
    - "Trails are grouped by country with visible country headers"
    - "Countries without trail data show 'Coming Soon' as a disabled option"
    - "Search filters trails across all country groups"
    - "All 11 weather API countries appear in the selector"
  artifacts:
    - path: "app/components/trails/TrailSelector.tsx"
      provides: "Country-grouped trail selector with optgroup-style headers"
      min_lines: 80
  key_links:
    - from: "app/components/trails/TrailSelector.tsx"
      to: "app/data/popularTrails.ts"
      via: "import popularTrails"
      pattern: "import.*popularTrails"
---

<objective>
Update the TrailSelector component to group trails by country with visible headers, and show "Coming Soon" for weather API countries that don't have trail data yet.

Purpose: With 250+ trails, a flat alphabetical list is unusable. Country grouping is essential for navigation. This UI work is independent of the data pipeline and can be built against the existing 107 trails.

Output: Updated TrailSelector.tsx with country-grouped display.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md

# Current component
@app/components/trails/TrailSelector.tsx
# Trail data interface
@app/data/popularTrails.ts (first 15 lines)
</context>

<tasks>

<task type="auto">
  <name>Task 1: Refactor TrailSelector to group trails by country</name>
  <files>app/components/trails/TrailSelector.tsx</files>
  <action>
Refactor the TrailSelector component to display trails grouped by country:

1. Define a constant for country display names and sort order:
   ```
   const COUNTRY_NAMES: Record<string, string> = {
     AU: 'Australia', CA: 'Canada', FR: 'France', DE: 'Germany',
     IT: 'Italy', JP: 'Japan', NZ: 'New Zealand', ZA: 'South Africa',
     CH: 'Switzerland', GB: 'United Kingdom', US: 'United States'
   };
   ```
   This covers all 11 weather API countries. Sort alphabetically by display name.

2. Define the list of ALL weather API countries (same 11). These are the countries shown in the selector regardless of trail data availability.

3. Group the filtered trails by country code. For each weather API country:
   - If trails exist for that country: render the country header followed by trail cards
   - If NO trails exist for that country: render the country header with a "Coming Soon" disabled indicator beneath it

4. Country header styling: sticky within the scroll container, bold text, slightly larger font, subtle background color (e.g., bg-zinc-50), top border for visual separation. Use a div with role="group" and aria-label for accessibility.

5. "Coming Soon" styling: italic, muted text (text-zinc-400), non-interactive, padded to match trail card indentation. Example: `<p className="text-sm italic text-zinc-400 py-3 px-4">Coming soon</p>`

6. Keep the existing search functionality -- search should filter trails across all groups. When searching, hide country groups that have zero matching trails (but don't hide "Coming Soon" countries -- they always show unless a search term is active, in which case hide all empty groups including Coming Soon ones).

7. Keep the existing trail card layout (name, region, distance, days, checkmark). No changes to the card itself.

8. Keep the "Showing X of Y trails" counter at the bottom.

9. Preserve the existing search input at the top. Add a note: also search by country name (add country name to the search filter logic -- if user types "Australia", show all AU trails).

10. Sort trails alphabetically within each country group.

11. The component should work correctly with the current 107 trails AND will automatically work with 250+ trails when the data file is updated (no hardcoded trail counts).
  </action>
  <verify>
Run `npm run build` to verify no TypeScript errors. Visually inspect by running `npm run dev` and navigating to the route builder page -- trails should be grouped under country headers.
  </verify>
  <done>
TrailSelector displays trails grouped under country headers. All 11 weather API countries appear. Countries without data show "Coming Soon". Search works across all groups including by country name. Existing functionality (select trail, show details) preserved.
  </done>
</task>

</tasks>

<verification>
1. `npm run build` passes
2. All 11 weather API countries visible in the trail selector
3. Trails correctly grouped under their country
4. Search filters across groups; empty groups hidden during search
5. "Coming Soon" shows for countries without trail data (currently none -- all 11 have data, but removing a country's trails from the data should trigger it)
</verification>

<success_criteria>
- TrailSelector groups trails by country with visible headers
- All 11 weather API countries shown (AU, CA, FR, DE, IT, JP, NZ, ZA, CH, GB, US)
- Search works across groups including by country name
- Existing trail selection behavior unchanged
- Build passes with no errors
</success_criteria>

<output>
After completion, create `.planning/phases/10-real-trail-data/10-02-SUMMARY.md`
</output>
