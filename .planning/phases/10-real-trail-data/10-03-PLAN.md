---
phase: 10-real-trail-data
plan: 03
type: execute
wave: 2
depends_on: ["10-01"]
files_modified:
  - scripts/trail-curation/trail-lists/us-trails.json
  - scripts/trail-curation/results/us-trails-batch1.json
  - scripts/trail-curation/results/us-trails-batch2.json
autonomous: true

must_haves:
  truths:
    - "100 curated US trails have real coordinate data from OSM or public sources"
    - "Each trail has 50-200 simplified coordinate points"
    - "Distance validation passes for all 100 trails (within 2% of official or flagged and fixed)"
  artifacts:
    - path: "scripts/trail-curation/trail-lists/us-trails.json"
      provides: "Curated list of 100 top US hiking trails with metadata"
      contains: "officialDistanceKm"
    - path: "scripts/trail-curation/results/us-trails-batch1.json"
      provides: "Fetched and validated trail data for US trails 1-50"
    - path: "scripts/trail-curation/results/us-trails-batch2.json"
      provides: "Fetched and validated trail data for US trails 51-100"
  key_links:
    - from: "scripts/trail-curation/trail-lists/us-trails.json"
      to: "scripts/trail-curation/batch-fetch.ts"
      via: "input file argument"
      pattern: "us-trails.json"
---

<objective>
Curate and fetch real coordinate data for the top 100 US hiking trails using the trail curation pipeline.

Purpose: US is the primary launch market. These 100 trails replace the current 10 simplified US trails with GPX-quality coordinate data from OpenStreetMap.

Output: Validated trail data JSON files containing 100 US trails with real coordinates, ready for integration into popularTrails.ts.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/10-real-trail-data/10-RESEARCH.md

# Pipeline built in Plan 01
@.planning/phases/10-real-trail-data/10-01-SUMMARY.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create curated US trail list and fetch batch 1 (trails 1-50)</name>
  <files>
    scripts/trail-curation/trail-lists/us-trails.json
    scripts/trail-curation/results/us-trails-batch1.json
  </files>
  <action>
1. Create `scripts/trail-curation/trail-lists/us-trails.json` containing exactly 100 TrailInput entries. The complete curated list of 100 US trails is below. For each trail, provide: name, searchName (OSM name if different from display name), region (state abbreviation), country ("US"), officialDistanceKm (research from Wikipedia/NPS/USFS -- public facts), typicalDays, bbox ([minLng, minLat, maxLng, maxLat] covering the trail area).

**THE COMPLETE 100 US TRAILS LIST:**

*Existing 10 (keep, upgrade coordinates):*
1. Pacific Crest Trail (CA/OR/WA)
2. Appalachian Trail (GA to ME)
3. John Muir Trail (CA)
4. Continental Divide Trail (MT/ID/WY/CO/NM)
5. Grand Canyon Rim-to-Rim (AZ)
6. Wonderland Trail (WA)
7. Teton Crest Trail (WY)
8. The Enchantments (WA)
9. Four Pass Loop (CO)
10. Isle Royale (Greenstone Ridge Trail) (MI)

*Long-distance iconic (11-20):*
11. Tahoe Rim Trail (CA/NV)
12. Colorado Trail (CO)
13. Long Trail (VT)
14. Superior Hiking Trail (MN)
15. Arizona Trail (AZ)
16. Ozark Highlands Trail (AR)
17. Ice Age Trail (WI)
18. Finger Lakes Trail (NY)
19. Ouachita Trail (AR/OK)
20. Bartram Trail (NC/GA)

*National Park classics -- Yosemite (21-25):*
21. Half Dome Trail (CA)
22. Clouds Rest Trail (CA)
23. Cathedral Lakes Trail (CA)
24. Mist Trail to Nevada Fall (CA)
25. Yosemite Grand Traverse (CA)

*National Park classics -- Zion & Bryce (26-30):*
26. Angels Landing (UT)
27. The Narrows (UT)
28. West Rim Trail (Zion) (UT)
29. Observation Point Trail (UT)
30. Navajo Loop / Queens Garden (Bryce Canyon) (UT)

*National Park classics -- Glacier (31-35):*
31. Highline Trail (Glacier) (MT)
32. Grinnell Glacier Trail (MT)
33. Hidden Lake Trail (MT)
34. Dawson Pass to Pitamakan Pass Loop (MT)
35. Iceberg Lake Trail (MT)

*National Park classics -- Grand Canyon (36-38):*
36. Bright Angel Trail (AZ)
37. South Kaibab Trail (AZ)
38. North Kaibab Trail (AZ)

*National Park classics -- Rocky Mountain (39-43):*
39. Longs Peak (CO)
40. Emerald Lake Trail (CO)
41. Sky Pond Trail (CO)
42. Flattop Mountain to Hallett Peak (CO)
43. Bear Lake to Fern Lake (CO)

*National Park classics -- Other parks (44-50):*
44. Mt Whitney (CA)
45. Kalalau Trail (HI)
46. Hoh River Trail (WA)
47. Skyline Trail (Mt Rainier) (WA)
48. Cascade Pass to Sahale Arm (WA)
49. Paintbrush Canyon / Cascade Canyon Loop (WY)
50. Lake Solitude Trail (WY)

*Western wilderness (51-65):*
51. Wind River High Route (WY)
52. Rae Lakes Loop (CA)
53. Trans-Catalina Trail (CA)
54. Lost Coast Trail (CA)
55. Trinity Alps Traverse (CA)
56. Rogue River Trail (OR)
57. Three Sisters Loop (OR)
58. Timberline Trail (Mt Hood) (OR)
59. Eagle Creek Trail (OR)
60. Sawtooth Traverse (ID)
61. Bob Marshall Traverse (MT)
62. Uinta Highline Trail (UT)
63. Zion Traverse (UT)
64. Capitol Reef (Waterpocket Fold) (UT)
65. Coyote Gulch (UT)

*Appalachian / Eastern (66-80):*
66. Franconia Ridge Traverse (NH)
67. Presidential Traverse (NH)
68. Pemi Loop (NH)
69. Great Smoky Mountains (AT section, Clingmans Dome) (TN/NC)
70. Knife Edge Trail (Katahdin) (ME)
71. Crawford Path (NH)
72. Cranberry Wilderness Loop (WV)
73. Dolly Sods Wilderness Loop (WV)
74. Linville Gorge Trail (NC)
75. Old Rag Circuit (VA)
76. Roan Highlands (AT section) (TN/NC)
77. Grafton Loop Trail (ME)
78. Mahoosuc Notch (AT section) (ME/NH)
79. Art Loeb Trail (NC)
80. Foothills Trail (SC/NC)

*Southwest / Desert (81-90):*
81. Havasupai Falls Trail (AZ)
82. Superstition Ridgeline Trail (AZ)
83. Grand Gulch (UT)
84. Escalante Route (Grand Canyon) (AZ)
85. Buckskin Gulch (UT/AZ)
86. The Wave approach (Coyote Buttes) (AZ)
87. Paria Canyon (UT/AZ)
88. Guadalupe Peak Trail (TX)
89. Chisos Basin Loop (Big Bend) (TX)
90. Dark Canyon (UT)

*Pacific Northwest / Alaska (91-96):*
91. Spray Park Trail (WA)
92. Goat Rocks Loop (WA)
93. Enchanted Valley Trail (WA)
94. Chilkoot Trail (AK)
95. Resurrection Pass Trail (AK)
96. Kesugi Ridge Trail (AK)

*Mountain West / Other (97-100):*
97. Highline Trail (Uintas) (UT)
98. Teton Loop via Alaska Basin (WY)
99. Glacier Peak Wilderness Loop (WA)
100. Beartooth Traverse (MT)

2. Split the 100-trail JSON into two files of 50 each: `us-trails-batch1.json` (trails 1-50) and `us-trails-batch2.json` (trails 51-100). Run batch-fetch for the first 50:
   ```
   npx tsx scripts/trail-curation/batch-fetch.ts scripts/trail-curation/trail-lists/us-trails-batch1.json scripts/trail-curation/results/us-trails-batch1.json
   ```

3. Review the results. For any failed trails:
   - Try alternate search names (e.g., "Half Dome Trail" vs "Half Dome" vs "Yosemite Half Dome")
   - Try broader bounding boxes
   - If still failing, note for manual resolution in the integration plan

4. For flagged trails (distance >2% off):
   - Check if the OSM data is a section rather than the full trail
   - Try alternate OSM relations
   - Record the flag for review but don't block -- we'll fix in the integration plan
  </action>
  <verify>
Check results file: it should contain ~50 trail objects. Count successes vs failures. Calculate: at least 40/50 (80%) should succeed on first pass. Print summary of any failures/flags.
  </verify>
  <done>
US trail list of 100 trails is curated with metadata. First batch of 50 trails fetched from OSM with real coordinates. Success rate documented. Failures logged for retry.
  </done>
</task>

<task type="auto">
  <name>Task 2: Fetch US trails batch 2 (trails 51-100) and resolve failures</name>
  <files>
    scripts/trail-curation/results/us-trails-batch2.json
  </files>
  <action>
1. Run batch-fetch for trails 51-100:
   ```
   npx tsx scripts/trail-curation/batch-fetch.ts scripts/trail-curation/trail-lists/us-trails-batch2.json scripts/trail-curation/results/us-trails-batch2.json
   ```

2. Review results. For failures from both batches, attempt resolution:
   - Try different search terms or OSM relation IDs
   - For short trails or well-known peaks that may not be hiking "routes" in OSM (e.g., summit approaches), try querying for `way[highway=path]["name"~"..."]` instead of route relations
   - For trails that genuinely aren't in OSM, create a manual entry note (these will be manually traced or sourced from government data in the integration plan)

3. Retry failed trails individually using fetch-trail:
   ```
   npx tsx -e "import {fetchTrail} from './scripts/trail-curation/fetch-trail'; fetchTrail({name: 'Trail Name', ...}).then(r => console.log(JSON.stringify(r, null, 2)))"
   ```

4. Target: at least 85 of 100 US trails should have successful OSM data after retries. The remaining 15 can be handled with manual coordinate entry or government data in the integration plan.

5. Merge successful results from both batches and retries into final result files.
  </action>
  <verify>
Count total successful US trails across both batch results. Should be >= 85/100. Print list of any remaining failures with reasons.
  </verify>
  <done>
100 US trails attempted. At least 85 have real OSM coordinate data. Remaining failures documented with reasons and suggested resolution approach.
  </done>
</task>

</tasks>

<verification>
1. `scripts/trail-curation/trail-lists/us-trails.json` contains exactly 100 trail entries
2. Result files contain trail objects with 50-200 coordinate points each
3. At least 85% success rate from OSM queries
4. Failed trails have documented reasons and resolution plans
5. No duplicate trails in the list
</verification>

<success_criteria>
- 100 curated US trail definitions exist in trail-lists/us-trails.json
- At least 85 trails have real coordinate data from OSM
- Each successful trail has 50-200 simplified coordinate points
- Distance validation run on all successful trails
- Failures are documented, not silently dropped
</success_criteria>

<output>
After completion, create `.planning/phases/10-real-trail-data/10-03-SUMMARY.md`
</output>
